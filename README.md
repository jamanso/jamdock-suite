# jamdock-suite
This suite is designed to support researchers in the early stages of drug discovery and drug repurposing projects, helping to streamline large-scale virtual screening workflows and lower the barriers to performing molecular docking experiments. The suite includes five Bash scripts to simplify and automate key steps in a virtual screening pipeline such as compound library preparation, receptor setup, automated docking, job resumption, and docking result analysis, using tools such as QuickVina 2, Open Babel, AutoDockTools and fpocket.

## Content

- `jamlib` – Automatically generates compound libraries in PDBQT format, including FDA-approved drugs and custom libraries of purchasable compounds, ready for use with QuickVina 2. **Important note:** This program downloads compounds from the free ZINC database (zinc.docking.org), provided by the Irwin and Shoichet Laboratories, and from files.docking.org and files2.docking.org. According to the original license from files.docking.org: *"Whereas you are free to share results derived from the use of these files, you may not redistribute major portions without the express written permission of John Irwin: chemistry4biology at gmail dot com"*. Therefore, the compound libraries generated by this program are for PERSONAL, ACADEMIC, and NON-COMMERCIAL use only. Redistribution or sharing of these files with third parties is LIMITED and must fully comply with the original license terms.
- `jamreceptor` – Prepares receptor structures (in PDB format) by converting them to PDBQT, identifying binding pockets using fpocket, and generating grid box configuration files.
- `jamqvina` – Automates the setup and execution of docking jobs with QuickVina 2, including parameter configuration and time estimation.
- `jamresume` – Enables the resumption of interrupted docking jobs, whether due to planned pauses or unexpected failures.
- `jamrank` – Provides two modes for analyzing docking results:
      - A fast mode that outputs affinities, ZINC links, and compound IDs.
      - A detailed mode that additionally computes a similarity score among poses, molecular weight, number of modes, and generates a comprehensive summary.

# System setup
jamdock-suite is designed to run into Linux- or Unix-based operating systems. Windows 11 users can install a desired Linux distribution under WSL (https://learn.microsoft.com/en-us/windows/wsl/install).
For macOS users, see [macOS Setup Instructions](./macos-setup.md).

Before running the scripts, make sure to install and set up your equipment by following the steps below. These instructions assume a clean system. If you already have some of the required software installed, you may skip the corresponding steps.

**1. Update and install essential packages:**

Open a terminal (Bash Shell) and execute
```bash
 sudo apt update && sudo apt upgrade -y
```
```bash
 sudo apt install -y build-essential gedit cmake openbabel pymol libxmu6 wget curl bc git libboost1.74-all-dev xutils-dev
```
**2. Install AutoDockTools (MGLTools)**
```bash
mkdir ~/Programs
cd ~/Programs
wget https://ccsb.scripps.edu/mgltools/download/491/mgltools_Linux-x86_64_1.5.7.tar.gz
tar -zxf mgltools_Linux-x86_64_1.5.7.tar.gz
cd mgltools_x86_64Linux2_1.5.7/
./install.sh
echo 'alias adt='$HOME/Programs/mgltools_x86_64Linux2_1.5.7/bin/adt'' >> ~/.bashrc
source ~/.bashrc
```
**3. Install fpocket**
```bash
cd ~/Programs
git clone https://github.com/Discngine/fpocket.git
cd fpocket
make
sudo make install
```
**4. Install QuickVina 2**
```bash
cd ~/Programs
git clone https://github.com/QVina/qvina.git
cd qvina
git checkout qvina2
```
Edit the top of the Makefile to match your Boost installation:
```bash
BOOST_VERSION=1_74
BOOST_INCLUDE = /usr/include
```
Build the program:
```bash
make
```
Configure environment variables for QuickVina 2.
```bash
echo 'alias qvina02='$HOME/Programs/qvina/qvina02'' >> ~/.bashrc
echo 'export PATH=$HOME/Programs/qvina:$PATH' >> ~/.bashrc
source ~/.bashrc
```
**5. Install jamdock-suite**
```bash
cd ~/Programs
git clone https://github.com/jamanso/jamdock-suite.git
cd jamdock-suite
chmod +x jam*
echo 'export PATH="$HOME/Programs/jamdock-suite:$PATH"' >> ~/.bashrc
source ~/.bashrc
```
# Getting started
To begin using the jamdock-suite, follow the steps below to set up and run a full virtual screening workflow. These steps assume you have installed all required dependencies and added the suite to your system PATH.

**1. Create a working directory**\
Start by creating a clean directory where user will locate their receptor of interest, **receptor.pdb**,  and where all input and output files will be stored:
```bash
mkdir ~/<your_project_name>
cd ~/<your_project_name>
```

**2. Generate a compound library (`jamlib`)**\
Execute `jamlib`and choose one of the two modes:
- FDA-approved compounds
- Custom compound library. You will be prompted to enter:\
            - Molecular weight (MW) range\
            - LogP range\
            - Number of compounds
 
After running this program, a library of 3D PDBQT compounds will be ready for docking.

**3. Prepare the receptor (`jamreceptor`)**\
This step sets up the receptor and docking grid.

After executing `jamreceptor`you will be prompted to enter:
- Name of the PDB file
- Chain ID(s) to analyze
- Binding pocket(s) to use (detected using fpocket)
- Padding size (in Ångströms)

Output files:

```bash
receptor_for_docking.pdbqt
grid.conf
grid_box.py
```

**4. Run the docking (`jamqvina`)**\
Dock the generated compounds libraries against the prepared receptor executing `jamqvina`. You will be prompted to provide:
- Receptor file name (e.g. receptor_for_docking.pdbqt)
- Exhaustiveness value
- Maximum number of modes
- Energy range
- Number of CPUs to use
- Whether the compound library is FDA-based (yes/no)

This script will execute docking jobs using QuickVina 2.

**Note:** If the docking job is interrupted (planned or unexpected), use the program `jamresume`to resume.

**5. Analyze Results (`jamrank`)**
Once docking is complete, analyze and rank the results executing `jamrank`. You will be asked to:
- Enter the number of top compounds to display
- Select a sorting method (fast or detailed)

Output includes ranked compounds by affinities of first mode, ZINC link and file name (option 1), and optionally with a similarity among the modes score, MW, number of modes (option 2).

# Citation

If you use this suite in your research, please cite the related Zenodo entry and other software publications:
- Manso, J.A. (2025). A collection of bash scripts for a virtual screening pipeline: from compound library generation to docking score evaluation. Zenodo, https://doi.org/10.5281/zenodo.15577778.
- O’Boyle, N.M., Banck, M., James, C.A., Morley, C., Vandermeersch, T., and Hutchison, G.R. (2011). Open Babel: An open chemical toolbox. Journal of Cheminformatics 3, 33. https://doi.org/10.1186/1758-2946-3-33.
- Morris, G.M., Huey, R., Lindstrom, W., Sanner, M.F., Belew, R.K., Goodsell, D.S., and Olson, A.J. (2009). AutoDock4 and AutoDockTools4: Automated Docking with Selective Receptor Flexibility. J Comput Chem 30, 2785–2791. https://doi.org/10.1002/jcc.21256.
- Le Guilloux, V., Schmidtke, P., and Tuffery, P. (2009). Fpocket: An open source platform for ligand pocket detection. BMC Bioinformatics 10, 168. https://doi.org/10.1186/1471-2105-10-168.
- Trott, O., and Olson, A.J. (2010). AutoDock Vina: Improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading. Journal of Computational Chemistry 31, 455–461. https://doi.org/10.1002/jcc.21334.
- Alhossary, A., Handoko, S.D., Mu, Y., and Kwoh, C.-K. (2015). Fast, accurate, and reliable molecular docking with QuickVina 2. Bioinformatics 31, 2214–2216. https://doi.org/10.1093/bioinformatics/btv082.
- Irwin, J.J., and Shoichet, B.K. (2005). ZINC − A Free Database of Commercially Available Compounds for Virtual Screening. J. Chem. Inf. Model. 45, 177–182. https://doi.org/10.1021/ci049714+.
- Sterling, T., and Irwin, J.J. (2015). ZINC 15 – Ligand Discovery for Everyone. J. Chem. Inf. Model. 55, 2324-2337. https://doi.org/10.1021/acs.jcim.5b00559.
- Irwin et al. (2020). ZINC20—A Free Ultralarge-Scale Chemical Database for Ligand Discovery. J. Chem. Inf. Model. 60, 6065–6073. https://doi.org/10.1021/acs.jcim.0c00675.

# License
This project is licensed under the Creative Commons Attribution-NonCommercial 4.0 International License. See the [LICENSE](https://github.com/jamanso/jamdock-suite/blob/main/LICENSE.txt) file for details.

# Contact
For questions or suggestions, please contact:

José Antonio Manso - joseantonio.manso@unican.es
